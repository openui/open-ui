---
menu: Active Proposals
name: Combobox2 (Explainer)
path: /components/combobox2.explainer
layout: ../../layouts/ComponentLayout.astro
---

import Image from '../../components/image.astro'

## Table of Contents

<!-- START doctoc generated TOC please keep comment here to allow auto update -->
<!-- DON'T EDIT THIS SECTION, INSTEAD RE-RUN doctoc TO UPDATE -->

- [Background](#background)
- [Use cases](#use-cases)
- [Opting in to the new behavior](#opting-in-to-the-new-behavior)
- [Datalist element](#datalist-element)
- [Options, focus, and keyboard behavior](#options-focus-and-keyboard-behavior)
- [Filtering behavior](#filtering-behavior)
- [Option element attributes](#option-element-attributes)
- [Examples](#examples)
  - [Basic](#basic)
- [Design decisions](#design-decisions)

<!-- END doctoc generated TOC please keep comment here to allow auto update -->

## Background

The combobox element currently supported by browsers by connecting an `<input type=text>` element to a `<datalist>` element does not provide enough customization for web developers, which leads them to implement their own. These implementations can lead to reduced performance, reliability, and accessibility compared to the native form control elements. More on that is in [Custom Control UI](https://github.com/MicrosoftEdge/MSEdgeExplainers/blob/main/ControlUICustomization/explainer.md#introduction).

OpenUI made a [Twitter poll](https://twitter.com/openuicg/status/1717345237889351911) which underscored the widespread demand for a customizable combobox:
<Image
  src="/images/combobox/combobox-twitterpoll.png"
  alt="Poll results which shows more interest in combobox than listbox, tooltip, or range/slider."
/>

This proposal adds functionality to the existing `<input>` with `<datalist>` to make it able to achieve the use cases needed for websites.

## Use cases

* Arbitrary styling for the datalist picker and its options:
  * Basic properties such as colors, padding, and font
  * Advanced styling such as highlighting individual characters in an option which the user searched for or changing styles of the filtered options
* Replacing the default filtering behavior with a custom filter implemented in script
* Dynamically and asynchronously adding options in response to text in the input element
  * This enables fetching options from a server and appending them into the datalist in response to the user typing into the input element

## Opting in to the new behavior

The `<input>` and `<datalist>` elements will continue to behave as they currently do unless they both have the `appearance:base` CSS propety applied to them.

Here is a basic example:
```html
<input list=datalist style="appearance:base">
<datalist id=datalist style="appearance:base">
  <option>one</option>
  <option>two</option>
</datalist>
```

## Datalist element

When the datalist element has base appearance, it will automatically become a popover without the need for the author to set the popover attribute on it. When the input element is focused, the datalist will be shown as a popover and anchored to the input element.

## Options, focus, and keyboard behavior

When the input element becomes focused, it will show the datalist. In order to allow the user to simultaneously type characters into the input element and choose options with the arrow keys and enter, the input element will always remain focused and the option which will be selected when pressing enter has the `:focused-option` pseudo-class.

## Filtering behavior

This will be covered by another explainer which also works for the `<select>` element.

## Option element attributes

Option elements rendered in a base appearance datalist will not render their label or value attributes. When an option is selected, its value attribute will be used to set the text inside of the input element in order to match the default native appearance.

## Examples

<!-- TODO add more examples and use code-image-container -->

### Basic

This example changes some padding, colors, and styling of the selected option.

```html
<input list=datalist>
<datalist id=datalist>
  <option>one</option>
  <option>two</option>
</datalist>
<style>
input, datalist {
  appearance: base;
}
input {
  border-radius: 0.5em;
  font-family: monospace;
}
datalist {
  border-radius: 0.5em;
}
option:focused-option {
  background-color: lightblue;
}
</style>
```

## Design decisions

- [Why not create a new combobox element](https://github.com/openui/open-ui/issues/1273)
- [Why not make the author put the popover attribute on datalist](https://github.com/openui/open-ui/issues/703)
